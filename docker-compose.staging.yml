# =============================================================
# librechat-admin-dashboard — STAGING
# Cambios respecto al docker-compose.yaml original:
#   1. El puerto 3000 NO se expone al host (solo red interna)
#   2. Se migra de "extend-librechat_default" a "extend-network"
#   3. Container name explícito para que nginx-proxy lo resuelva
# Usar con: docker compose -f docker-compose.staging.yml up -d
# =============================================================

services:
  next-app:
    build:
      context: .
      args:
        - MONGODB_URI=mongodb://extend-mongodb:27017/LibreChat
        - MONGODB_DB_NAME=LibreChat
        - NEXT_PUBLIC_BASE_PATH=/dashboard
    container_name: librechat-admin-dashboard
    # CAMBIO: Sin exposición de puerto al host
    expose:
      - "3000"
    environment:
      - MONGODB_URI=mongodb://extend-mongodb:27017/LibreChat
      - MONGODB_DB_NAME=LibreChat
      - DASHBOARD_PASSWORD=${DASHBOARD_PASSWORD:-admin}
      - SESSION_SECRET=${SESSION_SECRET:-default-session-secret-change-in-production}
    networks:
      - extend-network
    restart: always

networks:
  # CAMBIO: Ahora usa extend-network en lugar de extend-librechat_default
  extend-network:
    external: true
